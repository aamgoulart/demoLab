{"ast":null,"code":"import { BaseChartDirective } from 'ng2-charts';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../web-socket.service\";\nimport * as i2 from \"ng2-charts\";\n// import DataLabelsPlugin from 'chartjs-plugin-datalabels';\nexport class BarChartComponent {\n  constructor(webSocketService) {\n    this.webSocketService = webSocketService;\n    this.barChartOptions = {\n      responsive: true,\n      // We use these empty structures as placeholders for dynamic theming.\n      scales: {\n        x: {},\n        y: {}\n      },\n      plugins: {\n        legend: {\n          display: true\n        }\n        /*       datalabels: {\n                anchor: 'end',\n                align: 'end'\n              } */\n      }\n    };\n\n    this.barChartType = 'bar';\n    this.barChartData = {\n      labels: [],\n      datasets: [{\n        data: [],\n        label: 'Sinal A',\n        barPercentage: 0.09\n      }]\n    };\n    this.webSocketService.conectarWsLento();\n  }\n  ngOnDestroy() {\n    this.webSocketService.fecharComunicacao();\n  }\n  ngOnInit() {\n    this.sendMessage(\"\");\n    this.startFunction();\n  }\n  randomize() {\n    // Only Change 3 values\n    this.barChartData.datasets[0].data = [Math.round(Math.random() * 100), 59, 80, Math.round(Math.random() * 100), 56, Math.round(Math.random() * 100), 40];\n    this.chart?.update();\n  }\n  sendMessage(message) {\n    this.webSocketService.sendMessage(message);\n  }\n  adicionaNovoElemento() {\n    this.barChartData.datasets[0].data.push(this.webSocketService.valorAtual.message);\n    if (this.barChartData.datasets[0].data.length > 30) {\n      this.barChartData.datasets[0].data.shift();\n    }\n    this.barChartData?.labels?.push(`${this.webSocketService.valorAtual.time}`);\n    if (this.barChartData?.labels?.length > 31) {\n      this.barChartData?.labels?.shift();\n    }\n    this.chart?.update();\n  }\n  startFunction() {\n    const intervalId = setInterval(() => {\n      this.adicionaNovoElemento();\n      console.log(this.webSocketService.valorAtual);\n    }, 500);\n    setTimeout(() => {\n      clearInterval(intervalId);\n    }, 30000000);\n  }\n}\nBarChartComponent.ɵfac = function BarChartComponent_Factory(t) {\n  return new (t || BarChartComponent)(i0.ɵɵdirectiveInject(i1.WebSocketService));\n};\nBarChartComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n  type: BarChartComponent,\n  selectors: [[\"app-bar-chart\"]],\n  viewQuery: function BarChartComponent_Query(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵviewQuery(BaseChartDirective, 5);\n    }\n    if (rf & 2) {\n      let _t;\n      i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.chart = _t.first);\n    }\n  },\n  decls: 2,\n  vars: 3,\n  consts: [[1, \"container\"], [\"baseChart\", \"\", 1, \"chart\", 3, \"data\", \"options\", \"type\"]],\n  template: function BarChartComponent_Template(rf, ctx) {\n    if (rf & 1) {\n      i0.ɵɵelementStart(0, \"div\", 0);\n      i0.ɵɵelement(1, \"canvas\", 1);\n      i0.ɵɵelementEnd();\n    }\n    if (rf & 2) {\n      i0.ɵɵadvance(1);\n      i0.ɵɵproperty(\"data\", ctx.barChartData)(\"options\", ctx.barChartOptions)(\"type\", ctx.barChartType);\n    }\n  },\n  dependencies: [i2.BaseChartDirective],\n  styles: [\"\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsInNvdXJjZVJvb3QiOiIifQ== */\"]\n});","map":{"version":3,"mappings":"AAEA,SAASA,kBAAkB,QAAQ,YAAY;;;;AAI/C;AAOA,OAAM,MAAOC,iBAAiB;EAE5BC,YAAmBC,gBAAkC;IAAlC,qBAAgB,GAAhBA,gBAAgB;IAiB5B,oBAAe,GAAkC;MACtDC,UAAU,EAAE,IAAI;MAChB;MACAC,MAAM,EAAE;QACNC,CAAC,EAAE,EACF;QACDC,CAAC,EAAE;OAGJ;MAEDC,OAAO,EAAE;QACPC,MAAM,EAAE;UACNC,OAAO,EAAE;;QAEjB;;;;;KAKG;;IACM,iBAAY,GAAc,KAAK;IAE/B,iBAAY,GAAqB;MACtCC,MAAM,EAAE,EAAE;MACVC,QAAQ,EAAE,CACR;QAAGC,IAAI,EAAE,EAAG;QACRC,KAAK,EAAE,SAAS;QAAGC,aAAa,EAAE;MAAI,CAAE;KAG/C;IA9CC,IAAI,CAACZ,gBAAgB,CAACa,eAAe,EAAE;EACzC;EAGAC,WAAW;IACT,IAAI,CAACd,gBAAgB,CAACe,iBAAiB,EAAE;EAC3C;EAGAC,QAAQ;IACN,IAAI,CAACC,WAAW,CAAC,EAAE,CAAC;IACpB,IAAI,CAACC,aAAa,EAAE;EACtB;EAoCOC,SAAS;IACd;IACA,IAAI,CAACC,YAAY,CAACX,QAAQ,CAAC,CAAC,CAAC,CAACC,IAAI,GAAG,CACnCW,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG,GAAG,CAAC,EAC/B,EAAE,EACF,EAAE,EACFF,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG,GAAG,CAAC,EAC/B,EAAE,EACFF,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG,GAAG,CAAC,EAC/B,EAAE,CAAE;IAEN,IAAI,CAACC,KAAK,EAAEC,MAAM,EAAE;EACtB;EAEAR,WAAW,CAACS,OAAe;IACzB,IAAI,CAAC1B,gBAAgB,CAACiB,WAAW,CAACS,OAAO,CAAC;EAC5C;EAEAC,oBAAoB;IACnB,IAAI,CAACP,YAAY,CAACX,QAAQ,CAAC,CAAC,CAAC,CAACC,IAAI,CAACkB,IAAI,CAAC,IAAI,CAAC5B,gBAAgB,CAAC6B,UAAU,CAACH,OAAO,CAAC;IAEjF,IAAI,IAAI,CAACN,YAAY,CAACX,QAAQ,CAAC,CAAC,CAAC,CAACC,IAAI,CAACoB,MAAM,GAAE,EAAE,EAAE;MAClD,IAAI,CAACV,YAAY,CAACX,QAAQ,CAAC,CAAC,CAAC,CAACC,IAAI,CAACqB,KAAK,EAAE;;IAG1C,IAAI,CAACX,YAAY,EAAEZ,MAAM,EAAEoB,IAAI,CAAC,GAAI,IAAI,CAAC5B,gBAAgB,CAAC6B,UAAU,CAACG,IAAK,EAAE,CAAC;IAC7E,IAAI,IAAI,CAACZ,YAAY,EAAEZ,MAAM,EAAEsB,MAAO,GAAG,EAAE,EAAE;MAC3C,IAAI,CAACV,YAAY,EAAEZ,MAAM,EAAEuB,KAAK,EAAE;;IAGpC,IAAI,CAACP,KAAK,EAAEC,MAAM,EAAE;EACtB;EAEAP,aAAa;IACX,MAAMe,UAAU,GAAGC,WAAW,CAAC,MAAK;MAClC,IAAI,CAACP,oBAAoB,EAAE;MAC3BQ,OAAO,CAACC,GAAG,CAAC,IAAI,CAACpC,gBAAgB,CAAC6B,UAAU,CAAC;IAC/C,CAAC,EAAE,GAAG,CAAC;IAEPQ,UAAU,CAAC,MAAK;MACdC,aAAa,CAACL,UAAU,CAAC;IAC3B,CAAC,EAAE,QAAQ,CAAC;EACd;;AA7FWnC,iBAAiB;mBAAjBA,iBAAiB;AAAA;AAAjBA,iBAAiB;QAAjBA,iBAAiB;EAAAyC;EAAAC;IAAA;qBAiBjB3C,kBAAkB;;;;;;;;;;;;MC9B/B4C,8BAAuB;MACrBA,4BAIO;MAITA,iBAAM;;;MAPJA,eAAqB;MAArBA,uCAAqB","names":["BaseChartDirective","BarChartComponent","constructor","webSocketService","responsive","scales","x","y","plugins","legend","display","labels","datasets","data","label","barPercentage","conectarWsLento","ngOnDestroy","fecharComunicacao","ngOnInit","sendMessage","startFunction","randomize","barChartData","Math","round","random","chart","update","message","adicionaNovoElemento","push","valorAtual","length","shift","time","intervalId","setInterval","console","log","setTimeout","clearInterval","selectors","viewQuery","i0"],"sourceRoot":"","sources":["/home/pedro/Documentos/demoLab/src/app/bar-chart/bar-chart.component.ts","/home/pedro/Documentos/demoLab/src/app/bar-chart/bar-chart.component.html"],"sourcesContent":["import { Component, OnDestroy, OnInit, ViewChild } from '@angular/core';\nimport { ChartConfiguration, ChartData, ChartEvent, ChartType } from 'chart.js';\nimport { BaseChartDirective } from 'ng2-charts';\nimport { Observable, range } from 'rxjs';\nimport { WebSocketService } from '../web-socket.service';\n\n// import DataLabelsPlugin from 'chartjs-plugin-datalabels';\n\n@Component({\n  selector: 'app-bar-chart',\n  templateUrl: './bar-chart.component.html',\n  styleUrls: [ './bar-chart.component.scss' ],\n})\nexport class BarChartComponent implements OnInit, OnDestroy {\n\n  constructor(public webSocketService: WebSocketService) {\n    this.webSocketService.conectarWsLento();\n  }\n\n\n  ngOnDestroy() {\n    this.webSocketService.fecharComunicacao();\n  }\n\n\n  ngOnInit(): void {\n    this.sendMessage(\"\");\n    this.startFunction();\n  }\n\n  @ViewChild(BaseChartDirective) chart: BaseChartDirective | undefined;\n\n  public barChartOptions: ChartConfiguration['options'] = {\n    responsive: true,\n    // We use these empty structures as placeholders for dynamic theming.\n    scales: {\n      x: {\n      },// ajuste para alterar a largura das barras},\n      y: {\n      },\n\n    },\n\n    plugins: {\n      legend: {\n        display: true,\n      },\n/*       datalabels: {\n        anchor: 'end',\n        align: 'end'\n      } */\n    }\n  };\n  public barChartType: ChartType = 'bar';\n\n  public barChartData: ChartData<'bar'> = {\n    labels: [],\n    datasets: [\n      {  data: [ ]\n        , label: 'Sinal A' , barPercentage: 0.09,}\n    ],\n\n  };\n\n  public randomize(): void {\n    // Only Change 3 values\n    this.barChartData.datasets[0].data = [\n      Math.round(Math.random() * 100),\n      59,\n      80,\n      Math.round(Math.random() * 100),\n      56,\n      Math.round(Math.random() * 100),\n      40 ];\n\n    this.chart?.update();\n  }\n\n  sendMessage(message: string) {\n    this.webSocketService.sendMessage(message);\n  }\n\n  adicionaNovoElemento(): void {\n   this.barChartData.datasets[0].data.push(this.webSocketService.valorAtual.message);\n\n   if (this.barChartData.datasets[0].data.length> 30) {\n    this.barChartData.datasets[0].data.shift();\n   }\n\n    this.barChartData?.labels?.push(`${ this.webSocketService.valorAtual.time }`);\n    if (this.barChartData?.labels?.length! > 31) {\n      this.barChartData?.labels?.shift();\n    }\n\n    this.chart?.update();\n  }\n\n  startFunction() {\n    const intervalId = setInterval(() => {\n      this.adicionaNovoElemento();\n      console.log(this.webSocketService.valorAtual);\n    }, 500);\n\n    setTimeout(() => {\n      clearInterval(intervalId);\n    }, 30000000);\n  }\n\n  \n}\n\n","<div class=\"container\">\n  <canvas baseChart class=\"chart\"\n  [data]=\"barChartData\"\n  [options]=\"barChartOptions\"\n  [type]=\"barChartType\">\n</canvas>\n\n<!-- <button mat-button mat-raised-button color=\"primary\" (click)=\"randomize()\">Update</button> -->\n\n</div>\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}